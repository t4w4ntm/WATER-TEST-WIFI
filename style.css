/* =====================
   Minimal Monochrome Tokens
   ===================== */
:root{
  --bg:#ffffff;
  --txt:#111111;
  --muted:#6b7280;
  --border:#e5e7eb;
  --card:#ffffff;
  --shadow:0 1px 2px rgba(0,0,0,.06),0 8px 24px rgba(0,0,0,.06);
  --focus:#111111;
  --thead:#f8fafc;
}
html[data-theme="dark"]{
  --bg:#0a0a0a;
  --txt:#f5f5f5;
  --muted:#a3a3a3;
  --border:#27272a;
  --card:#0f0f10;
  --shadow:none;
  --focus:#e5e5e5;
  --thead:#111214;
}

*{box-sizing:border-box}
body{
  margin:0; background:var(--bg); color:var(--txt);
  font:15px/1.7 "Noto Sans Thai",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
.container{max-width:1100px; margin:auto; padding:20px 16px;}

/* ===== Header ===== */
.header{display:flex; align-items:center; gap:12px; justify-content:space-between; padding:4px 0 16px;}
.brand{display:flex; align-items:center; gap:10px;}
.brand h1{margin:0; font-size:clamp(18px,2.6vw,22px); letter-spacing:.2px;}
.badge{border:1px solid var(--border); border-radius:999px; padding:6px 10px; color:var(--muted);}

/* ===== Section Title ===== */
.section{margin:18px 0 10px; display:flex; align-items:center; gap:10px;}
.section h2{margin:0; font-size:clamp(16px,2.3vw,18px);}
.rule{flex:1; height:1px; background:var(--border);}

/* ===== Controls (Filters) ===== */
.filters{background:var(--bg); padding:12px 0; border-top:1px solid var(--border); border-bottom:1px solid var(--border); position:static;}
.grid{display:grid; gap:10px;}
.grid.cols-4{grid-template-columns:repeat(4,1fr);} 
.grid.cols-3{grid-template-columns:repeat(3,1fr);} 
.grid.cols-2{grid-template-columns:repeat(2,1fr);} 
@media (max-width:980px){ .grid.cols-4{grid-template-columns:repeat(2,1fr);} }
@media (max-width:560px){ .grid.cols-4, .grid.cols-3, .grid.cols-2{grid-template-columns:1fr;} }

.field{display:flex; flex-direction:column; gap:6px;}
.label{font-size:12px; color:var(--muted);} 
.field[data-click-focus]{cursor:pointer; border-radius:12px; transition:background .18s, box-shadow .18s; padding:4px 6px 8px; margin:-4px -6px 0;} 
.field[data-click-focus]:hover{background:rgba(0,0,0,.04);} 
html[data-theme="dark"] .field[data-click-focus]:hover{background:rgba(255,255,255,.05);} 
.field[data-click-focus]:focus-within{outline:2px solid var(--focus); outline-offset:2px;}
select, input[type="date"], input[type="datetime-local"], button.btn{width:100%; appearance:none; padding:9px 10px; border:1px solid var(--border); border-radius:10px; background:var(--card); color:var(--txt); box-shadow:var(--shadow); font:inherit; transition:all .2s ease;}
select, input[type="date"], input[type="datetime-local"], .quick, .chip, .btn, .field[data-click-focus]{cursor:pointer;}
select:focus, input:focus, .btn:focus{outline:2px solid var(--focus); outline-offset:1px;}
.btn{cursor:pointer; transition:all .2s ease;} 
.btn:hover{transform:translateY(-1px); box-shadow:0 4px 12px rgba(0,0,0,.15);}
html[data-theme="dark"] .btn:hover{box-shadow:0 4px 12px rgba(255,255,255,.1);}
.btn.secondary{background:var(--bg);} 
.btn.export{background:#111; color:#fff; font-weight:600;}
html[data-theme="dark"] .btn.export{background:#fff; color:#000;}
.btn.export:hover{filter:brightness(1.06);} 
html[data-theme="dark"] .btn.export:hover{filter:brightness(.94);} 
.quick{display:flex; gap:8px; flex-wrap:wrap;} 
.chip{padding:8px 10px; border:1px solid var(--border); border-radius:999px; background:var(--bg); cursor:pointer; color:var(--txt); transition:all .2s ease;} 
.chip:hover{transform:translateY(-1px); box-shadow:0 4px 12px rgba(0,0,0,.1); background:rgba(0,0,0,.02);}
html[data-theme="dark"] .chip:hover{box-shadow:0 4px 12px rgba(255,255,255,.08); background:rgba(255,255,255,.05);}
.chip[aria-pressed="true"]{border:3px solid var(--txt); padding:6px 8px; font-weight:600;} 
.chip[aria-pressed="true"]:hover{transform:translateY(-1px); box-shadow:0 4px 12px rgba(0,0,0,.15);}
html[data-theme="dark"] .chip[aria-pressed="true"]:hover{box-shadow:0 4px 12px rgba(255,255,255,.12);}
.chip.export{background:#111; color:#fff; font-weight:600; border-color:#111;}
html[data-theme="dark"] .chip.export{background:#fff; color:#000; border-color:#fff;}
.chip.export:hover{filter:brightness(1.06); transform:translateY(-1px); box-shadow:0 4px 16px rgba(0,0,0,.25);} 
html[data-theme="dark"] .chip.export:hover{filter:brightness(.94); box-shadow:0 4px 16px rgba(255,255,255,.2);} 

/* ===== Cards / KPIs ===== */
.kpis{display:grid; gap:10px; grid-template-columns:repeat(4,1fr); grid-auto-rows:1fr;}
/* Adjust for medium screens */
@media (max-width:980px){ .kpis{grid-template-columns:repeat(2,1fr); grid-auto-rows:auto;} }
/* Mobile: single column */
@media (max-width:560px){ .kpis{grid-template-columns:1fr;} }
/* Desktop specific ordering for water quality parameters:
   Row1: pH | EC | DO | ORP
   Row2: Turbidity | TDS | Temp | Signal */
@media (min-width:981px){
  .kpis{grid-template-areas:
    "ph ec do orp"
    "turbidity tds temp sig";}
  .kpis .card:nth-child(1){grid-area:ph;}         /* pH */
  .kpis .card:nth-child(2){grid-area:ec;}         /* EC */
  .kpis .card:nth-child(3){grid-area:do;}         /* DO */
  .kpis .card:nth-child(4){grid-area:orp;}        /* ORP */
  .kpis .card:nth-child(5){grid-area:turbidity;}  /* Turbidity */
  .kpis .card:nth-child(6){grid-area:tds;}        /* TDS */
  .kpis .card:nth-child(7){grid-area:temp;}       /* Temperature */
  .kpis .card:nth-child(8){grid-area:sig;}        /* Signal */
}
.card{background:var(--card); border:1px solid var(--border); border-radius:14px; padding:12px; box-shadow:var(--shadow);} 
.kpi .name{font-size:12px; color:var(--muted);} 
.kpi .val{font-size:26px; font-weight:700; margin-top:2px;} 

/* ===== Chart / Summary ===== */
.panel{background:var(--card); border:1px solid var(--border); border-radius:14px; padding:12px; box-shadow:var(--shadow);} 
canvas{width:100% !important; height:340px !important;} 
@media (max-width:560px){ canvas{height:260px !important;} }
.summary{display:grid; grid-template-columns:repeat(auto-fit,minmax(140px,1fr)); gap:10px;} 
.summary .card{padding:10px;} 
.summary .t{font-size:12px; color:var(--muted);} 
.summary .v{font-weight:700} 

/* ===== Table ===== */
.table-wrap{overflow:auto; max-height:420px; background:var(--card); border:1px solid var(--border); border-radius:14px; box-shadow:var(--shadow);} 
table{width:100%; border-collapse:collapse; font-size:14px;} 
thead th{position:sticky; top:0; background:var(--thead); text-align:left; padding:10px 8px; border-bottom:1px solid var(--border);} 
tbody td{padding:10px 8px; border-bottom:1px solid var(--border);} 
tbody tr:hover{background:rgba(0,0,0,.03)} 
html[data-theme="dark"] tbody tr:hover{background:rgba(255,255,255,.04)} 

/* ===== Theme toggle ===== */
.tools{display:flex; align-items:center; gap:8px; flex-wrap:wrap;} 
.spacer{flex:1} 

/* Toast feedback */
#toastStack{position:fixed; top:10px; right:10px; display:flex; flex-direction:column; gap:8px; z-index:9999; pointer-events:none;} 
.toast{background:var(--card); color:var(--txt); border:1px solid var(--border); padding:10px 14px; border-radius:12px; box-shadow:var(--shadow); font-size:13px; opacity:0; transform:translateY(-6px); animation:toast-in .35s ease forwards;} 
.toast.out{animation:toast-out .35s ease forwards;} 
@media (max-width:640px){
  #toastStack{top:auto; bottom:14px; right:auto; left:12px;}
}

/* ===== Battery iPhone Style ===== */
.battery-display{display:flex; align-items:center; gap:8px; margin-top:4px;}
.battery-icon{display:flex; align-items:center; height:34px;}
.battery-body{position:relative; width:72px; height:28px; border:2px solid var(--border); border-radius:8px; padding:4px; box-sizing:border-box; display:flex; align-items:center; justify-content:center; overflow:hidden;}
.battery-cap{width:9px; height:20px; margin-left:8px; border-radius:3px; background:var(--border);} 
.battery-fill{position:absolute; top:4px; left:4px; height:calc(100% - 8px); width:0%; background:var(--bat-green, #54a24b); border-radius:4px; transition:width .45s cubic-bezier(.4,.02,.2,1), background .3s ease, opacity .3s ease;}
.header-battery{height:26px;}
.header-battery .battery-body{width:56px; height:22px; padding:3px; border-radius:6px;}
.header-battery .battery-cap{height:16px; width:7px; margin-left:6px;}
.header-battery .battery-fill{top:3px; left:3px; height:calc(100% - 6px); border-radius:3px;}
.header-battery .battery-text{font-size:11px;}
.kpi-heading-battery{transform:scale(.9); transform-origin:left center;}
@media (max-width:640px){ .kpi-heading-battery{transform:scale(.8);} }
/* Theme icon swap */
/* Cross-fade sun/moon */
.icon-sun, .icon-moon{display:inline-flex; position:relative; transition:opacity .4s ease, transform .45s cubic-bezier(.4,.02,.2,1);} 
.icon-moon{position:absolute; top:50%; left:50%; transform:translate(-50%,-50%) scale(.85);} 
/* Light theme: sun visible, moon hidden */
html[data-theme="light"] .icon-sun{opacity:1;}
html[data-theme="light"] .icon-moon{opacity:0; pointer-events:none;}
/* Dark theme: moon visible, sun hidden */
html[data-theme="dark"] .icon-sun{opacity:0; pointer-events:none; transform:scale(.9);}
html[data-theme="dark"] .icon-moon{opacity:1; transform:translate(-50%,-50%) scale(1);} 
.battery-fill.low{background:var(--bat-red, #e45756);} 
.battery-fill.mid{background:var(--bat-yellow, #f2af58);} 
.battery-fill.missing{opacity:.35; background:var(--border);} 
.battery-fill.blink{animation:bat-blink 1s linear infinite;} 
/* Text inside battery (percentage) */
.battery-text{position:relative; z-index:2; font-size:13px; font-weight:600; line-height:1; color:var(--txt); text-align:center; letter-spacing:.4px; text-shadow:0 0 2px rgba(0,0,0,.45);} 
html[data-theme="dark"] .battery-text{text-shadow:0 0 2px rgba(0,0,0,.7);} 
@keyframes bat-blink{0%,60%{opacity:1;} 60.01%,100%{opacity:.25;}} 
.battery-percent .val{font-size:22px; font-weight:700; line-height:1;} 
html[data-theme="dark"] .battery-body{border-color:#3d3d3d;} 
html[data-theme="dark"] .battery-cap{background:#3d3d3d;} 
/* Smaller variant on narrow phones to avoid wrapping */
@media (max-width:640px){
  .battery-icon{height:30px;}
  .battery-body{width:64px; height:24px; padding:3px;}
  .battery-cap{width:8px; height:18px; margin-left:6px;}
  .battery-fill{top:3px; left:3px; height:calc(100% - 6px); border-radius:3px;}
  .battery-text{font-size:12px;}
}
@media (max-width:480px){
  .battery-icon{height:26px;}
  .battery-body{width:52px; height:20px; padding:2px;}
  .battery-cap{width:7px; height:16px; margin-left:5px;}
  .battery-fill{top:2px; left:2px; height:calc(100% - 4px); border-radius:2px;}
  .battery-text{font-size:11px;}
}
@keyframes toast-in{to{opacity:1; transform:translateY(0);} } 
@keyframes toast-out{to{opacity:0; transform:translateY(-4px);} } 
.sr-only{position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0 0 0 0); white-space:nowrap; border:0;} 
.invalid{border-color:#dc2626 !important; box-shadow:0 0 0 1px #dc2626 inset, var(--shadow);}  
.field.error-state .label{color:#dc2626;} 

/* Date icon tweak (dark theme) */
html[data-theme="dark"] input[type="date"], html[data-theme="dark"] input[type="datetime-local"]{ color-scheme: dark; }
html[data-theme="dark"] input[type="date"]::-webkit-calendar-picker-indicator, html[data-theme="dark"] input[type="datetime-local"]::-webkit-calendar-picker-indicator{ filter:invert(1) brightness(2) contrast(1.15) saturate(0); opacity:1; }
/* Force pure white calendar icon in dark theme (Chrome/Edge/Safari WebKit) */
html[data-theme="dark"] input[type="date"]::-webkit-calendar-picker-indicator,
html[data-theme="dark"] input[type="datetime-local"]::-webkit-calendar-picker-indicator{
  background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' stroke='white' fill='none' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='5' width='18' height='16' rx='2' ry='2'/%3E%3Cline x1='3' y1='10' x2='21' y2='10'/%3E%3Cline x1='8' y1='1' x2='8' y2='5'/%3E%3Cline x1='16' y1='1' x2='16' y2='5'/%3E%3C/svg%3E") center/16px 16px no-repeat;
  filter:none !important;
  opacity:1 !important;
  color:transparent;
}
html[data-theme="dark"] input[type="date"]::-webkit-calendar-picker-indicator:hover, html[data-theme="dark"] input[type="datetime-local"]::-webkit-calendar-picker-indicator:hover{ opacity:1; }
/* Mobile date input placeholder enhancement */
@media (max-width:768px){
  input[type="date"]:not(:focus):invalid {
    color:var(--muted);
  }
  input[type="date"][data-placeholder]:not(:focus):invalid::before {
    content: attr(data-placeholder);
    color:var(--muted);
    margin-right:0.5em;
  }
  /* iOS Safari specific fix */
  input[type="date"]::-webkit-datetime-edit-text,
  input[type="date"]::-webkit-datetime-edit-month-field,
  input[type="date"]::-webkit-datetime-edit-day-field,
  input[type="date"]::-webkit-datetime-edit-year-field {
    color:var(--muted);
  }
  input[type="date"]:focus::-webkit-datetime-edit-text,
  input[type="date"]:focus::-webkit-datetime-edit-month-field, 
  input[type="date"]:focus::-webkit-datetime-edit-day-field,
  input[type="date"]:focus::-webkit-datetime-edit-year-field {
    color:var(--txt);
  }
}

/* Floating theme toggle */
.floating-toggle{position:fixed; bottom:18px; right:18px; z-index:10000; background:var(--card); color:var(--txt); border:1px solid var(--border); padding:12px; border-radius:50%; width:48px; height:48px; display:flex; align-items:center; justify-content:center; box-shadow:var(--shadow); cursor:pointer; font:inherit; font-size:18px; transition:all .2s ease;}
.floating-toggle:hover{background:var(--bg); transform:translateY(-2px); box-shadow:0 6px 20px rgba(0,0,0,.15);} 
html[data-theme="dark"] .floating-toggle:hover{background:#1a1a1a; box-shadow:0 6px 20px rgba(255,255,255,.1);} 

/* ===== Mobile Responsive Enhancements ===== */
@media (max-width:640px){
  /* Hide updated badge on mobile */
  .badge#updated{display:none;}
  /* Show mobile theme toggle chip, hide floating button */
  #themeToggle{display:none !important;}
  .mobile-theme-toggle{display:inline-block !important;}
  /* Filters: force 2x2 layout (4 items -> 2 columns) */
  .filters .grid.cols-4{grid-template-columns:repeat(2,1fr);} 
  /* KPIs: 2 columns, 4 rows */
  .kpis{grid-template-columns:repeat(2,1fr); grid-template-rows:repeat(4,auto);} 
  /* Hamburger visible */
  .hamburger{display:inline-flex !important; flex-direction:column; justify-content:center; gap:4px; width:42px; height:42px; background:var(--card); border:1px solid var(--border); border-radius:10px; padding:6px 8px; cursor:pointer; box-shadow:var(--shadow); transition:all .25s ease;} 
  .hamburger span{display:block; height:3px; width:100%; background:var(--txt); border-radius:2px; transition:all .25s ease;} 
  /* Transform bars when active */
  body.show-tools .hamburger span:nth-child(1){transform:translateY(7px) rotate(45deg);} 
  body.show-tools .hamburger span:nth-child(2){opacity:0;} 
  body.show-tools .hamburger span:nth-child(3){transform:translateY(-7px) rotate(-45deg);} 
  /* Collapse quick tools by default */
  #quickTools{position:absolute; top:60px; right:16px; background:var(--card); border:1px solid var(--border); border-radius:14px; padding:8px 0; box-shadow:var(--shadow); display:none; flex-direction:column; width:min(230px,88vw); z-index:9500;} 
  body.show-tools #quickTools{display:flex;} 
  #quickTools .quick{flex-direction:column; align-items:stretch; width:100%; gap:0;} 
  #quickTools .quick .chip{width:100%; border-radius:0; justify-content:flex-start; padding:12px 18px; margin:0; border:0; border-bottom:1px solid var(--border); background:var(--card); box-shadow:none; text-align:left; font-size:15px; font-weight:500; position:relative;} 
  /* Ensure no underlying form controls bleed through */
  #quickTools .quick .chip::after{content:""; position:absolute; inset:0; pointer-events:none;}
  #quickTools .quick .chip:first-child{border-top:0;} 
  #quickTools .quick .chip:last-child{border-bottom:0;} 
  #quickTools .quick .chip.export{font-weight:600;} 
  #quickTools .quick .chip:hover{background:var(--bg);} 
  html[data-theme="dark"] #quickTools .quick .chip:hover{background:#1d1d1d;} 
  /* Mobile Export text color overrides */
  html[data-theme="light"] #quickTools .quick .chip.export{color:#000;}
  html[data-theme="dark"] #quickTools .quick .chip.export{color:#fff;}
}


